{% extends "base.html" %}

{% block content %}
    <!-- –°–µ–∫—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤ –∑–∞–¥–∞—á -->
    <section id="task-lists-section" class="content-section">
        <div class="section-header">
            <h2>üìÅ –ú–æ–∏ —Å–ø–∏—Å–∫–∏ –∑–∞–¥–∞—á</h2>
            <button class="btn btn-primary" id="create-task-list-btn">+ –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫</button>
        </div>
        <div id="task-lists-container" class="cards-container">
            <!-- –°–ø–∏—Å–∫–∏ –∑–∞–¥–∞—á –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
    </section>

    <!-- –°–µ–∫—Ü–∏—è –∑–∞–¥–∞—á -->
    <section id="tasks-section" class="content-section hidden">
        <div class="section-header">
            <h2 id="current-list-name">üìã –ó–∞–¥–∞—á–∏</h2>
            <button class="btn btn-primary" id="create-task-btn">+ –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</button>
        </div>
        <div id="tasks-container" class="cards-container">
            <!-- –ó–∞–¥–∞—á–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
    </section>

    <!-- –°–µ–∫—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <section id="notifications-section" class="content-section hidden">
        <div class="section-header">
            <h2>üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
            <button class="btn btn-secondary" id="mark-all-read-btn">–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ</button>
        </div>
        <div id="notifications-container">
            <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
    </section>

    <!-- –°–µ–∫—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
    <section id="profile-section" class="content-section hidden">
        <div class="section-header">
            <h2>üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
        </div>
        <div class="profile-content">
            <div class="profile-card">
                <div class="profile-header">
                    <div class="avatar">
                        {% if user.profile.avatar %}
                            <img src="{{ user.profile.avatar.url }}" alt="–ê–≤–∞—Ç–∞—Ä">
                        {% else %}
                            <div class="avatar-placeholder">{{ user.username|first|upper }}</div>
                        {% endif %}
                    </div>
                    <div class="profile-info">
                        <h3>{{ user.get_full_name|default:user.username }}</h3>
                        <p class="profile-email">{{ user.email }}</p>
                        {% if user.telegram_username %}
                            <p class="profile-telegram">üì± Telegram: @{{ user.telegram_username }}</p>
                        {% endif %}
                    </div>
                </div>
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-number">{{ user.assigned_tasks.count }}</span>
                        <span class="stat-label">–ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">{{ user.created_tasks.count }}</span>
                        <span class="stat-label">–°–æ–∑–¥–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">{{ user.task_lists.count }}</span>
                        <span class="stat-label">–°–ø–∏—Å–∫–æ–≤ –∑–∞–¥–∞—á</span>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block modals %}
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="create-task-list-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</h3>
            <form id="task-list-form">
                <div class="form-group">
                    <label for="list-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞:</label>
                    <input type="text" id="list-name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="list-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea id="list-description" name="description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="list-color">–¶–≤–µ—Ç:</label>
                    <input type="color" id="list-color" name="color" value="#3498db">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="taskManager.hideModal('create-task-list-modal')">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="create-task-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</h3>
            <form id="task-form">
                <div class="form-group">
                    <label for="task-title">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏:</label>
                    <input type="text" id="task-title" name="title" required>
                </div>
                <div class="form-group">
                    <label for="task-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea id="task-description" name="description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="task-priority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</label>
                    <select id="task-priority" name="priority">
                        <option value="low">üîµ –ù–∏–∑–∫–∏–π</option>
                        <option value="medium" selected>üü° –°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="high">üü† –í—ã—Å–æ–∫–∏–π</option>
                        <option value="urgent">üî¥ –°—Ä–æ—á–Ω—ã–π</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="task-due-date">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</label>
                    <input type="datetime-local" id="task-due-date" name="due_date">
                </div>
                <div class="form-group">
                    <label for="task-assigned-to">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</label>
                    <select id="task-assigned-to" name="assigned_to">
                        <option value="">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</option>
                        <!-- Users will be populated dynamically -->
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="taskManager.hideModal('create-task-modal')">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div id="login-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h3>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="login-username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="login-password">–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="login-password" name="password" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="taskManager.hideModal('login-modal')">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–í–æ–π—Ç–∏</button>
                </div>
            </form>
            <div class="auth-links">
                <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="taskManager.showRegisterForm()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div id="register-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
            <form id="register-form">
                <div class="form-group">
                    <label for="register-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="register-username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="register-email">Email:</label>
                    <input type="email" id="register-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="register-password">–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="register-password" name="password" required>
                </div>
                <div class="form-group">
                    <label for="register-password-confirm">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="register-password-confirm" name="password_confirm" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="taskManager.hideModal('register-modal')">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                </div>
            </form>
            <div class="auth-links">
                <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="taskManager.showLoginForm()">–í–æ–π—Ç–∏</a></p>
            </div>
        </div>
    </div>
{% endblock %}